<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Controle de Tarefas</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyAa_IPmOWZ4-KpWIC7huhhl7mYjYfEJhDk",
      authDomain: "diphouse-control.firebaseapp.com",
      databaseURL: "https://diphouse-control-default-rtdb.firebaseio.com",
      projectId: "diphouse-control",
      storageBucket: "diphouse-control.firebasestorage.app",
      messagingSenderId: "126387069829",
      appId: "1:126387069829:web:7e365252a98da884075aec"
    };
    firebase.initializeApp(firebaseConfig);
    var db = firebase.database();
  </script>
</head>
<body>

<h1>Controle de Tarefas</h1>

<input type="text" id="tarefaTexto" placeholder="Tarefa">
<label>
  <input type="checkbox" id="tarefaStatus" checked> Aberto
</label>
<button onclick="salvarTarefa()">Salvar</button>

<h2>Lista de Tarefas</h2>
<ul id="listaTarefas"></ul>

<script>
  function salvarTarefa() {
    var texto = document.getElementById('tarefaTexto').value;
    var status = document.getElementById('tarefaStatus').checked ? 'Aberto' : 'Fechado';
    db.ref('tarefas').push({
      texto: texto,
      status: status
    });
    document.getElementById('tarefaTexto').value = '';
    document.getElementById('tarefaStatus').checked = true;
  }

  function listarTarefas() {
    db.ref('tarefas').on('value', function(snapshot) {
      var lista = document.getElementById('listaTarefas');
      lista.innerHTML = '';
      snapshot.forEach(function(child) {
        var li = document.createElement('li');
        li.textContent = child.val().texto + ' (' + child.val().status + ') ';

        var btnEditar = document.createElement('button');
        btnEditar.textContent = 'Editar';
        btnEditar.onclick = function() {
          var novoTexto = prompt('Novo texto:', child.val().texto);
          var novoStatus = confirm('Marcar como Aberto?') ? 'Aberto' : 'Fechado';
          if (novoTexto !== null) {
            db.ref('tarefas/' + child.key).update({
              texto: novoTexto,
              status: novoStatus
            });
          }
        };

        var btnExcluir = document.createElement('button');
        btnExcluir.textContent = 'Excluir';
        btnExcluir.onclick = function() {
          if (confirm('Tem certeza?')) {
            db.ref('tarefas/' + child.key).remove();
          }
        };

        li.appendChild(btnEditar);
        li.appendChild(btnExcluir);
        lista.appendChild(li);
      });
    });
  }

  listarTarefas();
</script>

</body>
</html>
