<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Controle - Carrossel de Fotos</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyAa_IPmOWZ4-KpWIC7huhhl7mYjYfEJhDk",
      authDomain: "diphouse-control.firebaseapp.com",
      databaseURL: "https://diphouse-control-default-rtdb.firebaseio.com",
      projectId: "diphouse-control",
      storageBucket: "diphouse-control.appspot.com",
      messagingSenderId: "126387069829",
      appId: "1:126387069829:web:7e365252a98da884075aec"
    };
    firebase.initializeApp(firebaseConfig);
    var storage = firebase.storage();
  </script>
</head>
<body>

<h1>Upload de Fotos - Carrossel</h1>

<input type="file" id="fotoFile">
<button onclick="uploadFoto()">Enviar</button>

<h2>Fotos no Storage</h2>
<ul id="listaFotos"></ul>

<script>
  function uploadFoto() {
    var file = document.getElementById('fotoFile').files[0];
    if (!file) return alert('Selecione uma foto!');
    var storageRef = storage.ref('fotos/' + file.name);
    storageRef.put(file).then(function() {
      alert('Foto enviada!');
      listarFotos();
    });
  }

  function listarFotos() {
    var lista = document.getElementById('listaFotos');
    lista.innerHTML = '';
    storage.ref('fotos').listAll().then(function(res) {
      res.items.forEach(function(itemRef) {
        itemRef.getDownloadURL().then(function(url) {
          var li = document.createElement('li');
          li.textContent = itemRef.name + ' ';
          var btnExcluir = document.createElement('button');
          btnExcluir.textContent = 'Excluir';
          btnExcluir.onclick = function() {
            if (confirm('Excluir esta foto?')) {
              itemRef.delete().then(function() {
                alert('Foto exclu√≠da!');
                listarFotos();
              });
            }
          };
          li.appendChild(btnExcluir);
          lista.appendChild(li);
        });
      });
    });
  }

  listarFotos();
</script>

</body>
</html>
