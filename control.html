<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Controle de Agendamentos</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyAa_IPmOWZ4-KpWIC7huhhl7mYjYfEJhDk",
      authDomain: "diphouse-control.firebaseapp.com",
      databaseURL: "https://diphouse-control-default-rtdb.firebaseio.com",
      projectId: "diphouse-control",
      storageBucket: "diphouse-control.firebasestorage.app",
      messagingSenderId: "126387069829",
      appId: "1:126387069829:web:7e365252a98da884075aec"
    };
    firebase.initializeApp(firebaseConfig);
    var db = firebase.database();
  </script>
</head>
<body>

<h1>Controle de Agendamentos</h1>

<input type="date" id="agendamentoData">
<input type="text" id="agendamentoDetalhe" placeholder="Detalhe">
<select id="agendamentoCategoria">
  <option>Sa√∫de</option>
  <option>Trabalho</option>
  <option>Lazer</option>
</select>
<button onclick="salvarAgendamento()">Salvar</button>

<h2>Lista de Agendamentos</h2>
<ul id="listaAgendamentos"></ul>

<script>
  var editKey = null;

  function salvarAgendamento() {
    var data = document.getElementById('agendamentoData').value;
    var detalhe = document.getElementById('agendamentoDetalhe').value;
    var categoria = document.getElementById('agendamentoCategoria').value;

    if (editKey) {
      db.ref('agendamentos/' + editKey).update({
        data: data,
        detalhe: detalhe,
        categoria: categoria
      });
      editKey = null;
    } else {
      db.ref('agendamentos').push({
        data: data,
        detalhe: detalhe,
        categoria: categoria
      });
    }

    document.getElementById('agendamentoData').value = '';
    document.getElementById('agendamentoDetalhe').value = '';
  }

  function listarAgendamentos() {
    db.ref('agendamentos').on('value', function(snapshot) {
      var lista = document.getElementById('listaAgendamentos');
      lista.innerHTML = '';
      snapshot.forEach(function(child) {
        var li = document.createElement('li');
        li.textContent = child.val().data + ' - ' + child.val().detalhe + ' (' + child.val().categoria + ') ';
        
        var btnEditar = document.createElement('button');
        btnEditar.textContent = 'Editar';
        btnEditar.onclick = function() {
          document.getElementById('agendamentoData').value = child.val().data;
          document.getElementById('agendamentoDetalhe').value = child.val().detalhe;
          document.getElementById('agendamentoCategoria').value = child.val().categoria;
          editKey = child.key;
        };

        var btnExcluir = document.createElement('button');
        btnExcluir.textContent = 'Excluir';
        btnExcluir.onclick = function() {
          if (confirm('Tem certeza?')) {
            db.ref('agendamentos/' + child.key).remove();
          }
        };

        li.appendChild(btnEditar);
        li.appendChild(btnExcluir);
        lista.appendChild(li);
      });
    });
  }

  listarAgendamentos();
</script>

</body>
</html>
